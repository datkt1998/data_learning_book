

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>3. Data Cleaning &#8212; Machine Learning book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '2_My_Modules/1_Data_Cleaning';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4. Connection" href="2_Connection.html" />
    <link rel="prev" title="2.6. Docker" href="../4_Programming/7_Docker.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../_jupyter_book_files/intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../_jupyter_book_files/intro.html">
                    Welcome to Dat’s Notebook
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Process Modeling</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/0_toc_eda.html">1. Statistic and EDA</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/1_Statistics_and_EDA-0.html">1.1. Data Analyst Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/1_Statistics_and_EDA-1.html">1.2. Read datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/1_Statistics_and_EDA-2.html">1.3. Explore data analysis (EDA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/1_Statistics_and_EDA-3.html">1.4. Description statistic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/1_Statistics_and_EDA-4.html">1.5. Inferential statistic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/1_Statistics_and_EDA-5.html">1.6. Kiểm định giả thuyết (Hypothesis testing)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/1_Statistics_and_EDA-6.html">1.7. ANOVA</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/0_toc_fe.html">2. Feature Engineering</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/2_Feature_engineering-1.html">2.1. Custom Transforms Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/2_Feature_engineering-2.html">2.2. Feature extraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/2_Feature_engineering-3.html">2.3. Variable Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/2_Feature_engineering-4.html">2.4. Missing Imputation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/2_Feature_engineering-5.html">2.5. Categorical Encoding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/2_Feature_engineering-6.html">2.6. Feature transformation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/2_Feature_engineering-7.html">2.7. Discretisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/2_Feature_engineering-8.html">2.8. Outliers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/2_Feature_engineering-9.html">2.9. Feature scaling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/2_Feature_engineering-10.html">2.10. Feature selection</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/0_toc_imb.html">3. Imbalance Dataset Handling</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/3_Imbalance_data_handling-1.html">3.1. Data-level approaches</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/3_Imbalance_data_handling-2.html">3.2. Cost sensitive approaches</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/3_Imbalance_data_handling-3.html">3.3. Ensemble approaches</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/3_Imbalance_data_handling-4.html">3.4. Ensemble approaches</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/0_toc_fs.html">4. Feature Selection</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/3_Feature_selection_and_decomposition-1.html">4.1. Filter methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/3_Feature_selection_and_decomposition-2.html">4.2. Wrapped methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/3_Feature_selection_and_decomposition-3.html">4.3. Embedded methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/3_Feature_selection_and_decomposition-4.html">4.4. Hybrid methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/3_Feature_selection_and_decomposition-5.html">4.5. Feature decomposition</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/0_toc_eva.html">5. Evaluation Metrics</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/5_Evaluation_metrics-0.html">5.1. Define scorer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/5_Evaluation_metrics-1.html">5.2. Classification metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/5_Evaluation_metrics-2.html">5.3. Regression metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/5_Evaluation_metrics-3.html">5.4. Clustering metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/5_Evaluation_metrics-4.html">5.5. Pairwise metrics</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/6_Models_monitoring_production-0.html">6. Model Monitoring</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/6_Models_monitoring_production-1.html">6.7. Functional level monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/6_Models_monitoring_production-2.html">6.8. Operational level monitoring</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ML/DL Algorithms</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/0_toc_ml_su.html">1. ML Supervised Learning</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_ML_Supervised_learning_Algorithms-0.html">1.1. Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_ML_Supervised_learning_Algorithms-1.html">1.2. Naive Bayes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_ML_Supervised_learning_Algorithms-2.html">1.3. Discriminant Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_ML_Supervised_learning_Algorithms-3.html">1.4. Stochastic Gradient Descent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_ML_Supervised_learning_Algorithms-4.html">1.5. Support Vector Machines (SVM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_ML_Supervised_learning_Algorithms-5.html">1.6. Nearest neighbors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_ML_Supervised_learning_Algorithms-6.html">1.7. Tree-base model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_ML_Supervised_learning_Algorithms-7.html">1.8. Ensemble learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_ML_Supervised_learning_Algorithms-8.html">1.9. Multi-class and multi-output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_ML_Supervised_learning_Algorithms-9.html">1.10. Neural network models</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/0_toc_ml_unsu.html">2. ML Unsupervised Learning</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_ML_Unsupervised_learning_Algorithms-0.html">2.1. Clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_ML_Unsupervised_learning_Algorithms-1.html">2.2. Decomposing components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_ML_Unsupervised_learning_Algorithms-2.html">2.3. Manifold learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_ML_Unsupervised_learning_Algorithms-3.html">2.4. Novelty and Outlier Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_ML_Unsupervised_learning_Algorithms-4.html">2.5. Neural network</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/0_toc_dl.html">3. Deep Learning</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../1_Process_Modelling/Split_notebooks/4_DL_Algorithms-0.html">3.1. Neural Network</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">My Modules</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../3_Mathematics/0_toc.html">1. Mathematics</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../3_Mathematics/1_Linear_algebra.html">1.1. Linear algebra</a></li>



<li class="toctree-l2"><a class="reference internal" href="../3_Mathematics/2_Calculus_and_optimization.html">1.5. Calculus and optimization</a></li>






<li class="toctree-l2"><a class="reference internal" href="../3_Mathematics/3_Distribution_and_statistic.html">1.12. Distribution and statistics</a></li>

<li class="toctree-l2"><a class="reference internal" href="../3_Mathematics/4_Information_theory.html">1.14. Information theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3_Mathematics/5_Graph_theory.html">1.15. Graph theory</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../4_Programming/0_toc.html">2. Programming</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../4_Programming/1_SQL.html">2.1. SQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4_Programming/2_noSQL.html">2.2. noSQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4_Programming/3_pySpark.html">2.3. pySpark</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4_Programming/4_Python.html">2.4. Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4_Programming/6_Git.html">2.5. Git</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4_Programming/7_Docker.html">2.6. Docker</a></li>
</ul>
</li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">3. Data cleaning</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_Connection.html">4. Data connection</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/datkt1998/DS_learning_book" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/2_My_Modules/1_Data_Cleaning.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Data Cleaning</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#text">3.1. Text</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#custom-function">3.1.1. Custom function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dataprep-clean-text">3.1.2. Dataprep clean text</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#address">3.2. Address</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datetime">3.3. Datetime</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#person-info">3.4. Person info</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#idcard">3.5. IDCard</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#phone-number">3.6. Phone number</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#si">3.7. SI</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#taxid">3.8. TaxID</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#header-cleaning">3.9. Header cleaning</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="data-cleaning">
<h1><span class="section-number">3. </span>Data Cleaning<a class="headerlink" href="#data-cleaning" title="Permalink to this heading">#</a></h1>
<section id="text">
<h2><span class="section-number">3.1. </span>Text<a class="headerlink" href="#text" title="Permalink to this heading">#</a></h2>
<p>Chuẩn hóa dữ liệu text:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<section id="custom-function">
<h3><span class="section-number">3.1.1. </span>Custom function<a class="headerlink" href="#custom-function" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">remove_punctuation</span></code> : Xóa bỏ ký tự đặc biệt và đuôi float .0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">clean</span></code>: handle string-nan, space, end_dotzero, punctuation, unidecode</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">text</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Chuẩn hóa dữ liệu text</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">():</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">remove_punctuation</span><span class="p">(</span><span class="n">str_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Xóa bỏ ký tự đặc biệt và đuôi float .0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">str_data</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39; +&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">str_data</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;.0&#39;</span><span class="p">,</span><span class="s1">&#39;.00&#39;</span><span class="p">,</span><span class="s1">&#39;,0&#39;</span><span class="p">,</span><span class="s1">&#39;,00&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">str_data</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
                <span class="n">str_data</span> <span class="o">=</span> <span class="n">str_data</span><span class="p">[:</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">)]</span>
                <span class="k">break</span>
        <span class="n">str_data</span> <span class="o">=</span> <span class="n">str_data</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">maketrans</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">punctuation</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">str_data</span>

    <span class="k">def</span> <span class="nf">clean</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">space</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">end_dotzero</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">punc</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">nan</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">use_unidecode</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert nan/none value ở dạng string thành NaN</span>

<span class="sd">        Returns:</span>
<span class="sd">            _type_: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">space_clean</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39; +&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">end_dotzero_clean</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;.0&#39;</span><span class="p">,</span><span class="s1">&#39;.00&#39;</span><span class="p">,</span><span class="s1">&#39;,0&#39;</span><span class="p">,</span><span class="s1">&#39;,00&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="p">[:</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">)]</span>
                    <span class="k">break</span>
            <span class="k">return</span> <span class="n">value</span>

        <span class="k">def</span> <span class="nf">punctuation_clean</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">value</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">maketrans</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">punctuation</span><span class="p">))</span>

        <span class="k">def</span> <span class="nf">nan_clean</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="n">nan_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;#n/a&#39;</span><span class="p">,</span> <span class="s1">&#39;#n/a n/a&#39;</span><span class="p">,</span> <span class="s1">&#39;#na&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;#ref!&#39;</span><span class="p">,</span> <span class="s1">&#39;(null)&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.#ind&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;-1.#qnan&#39;</span><span class="p">,</span> <span class="s1">&#39;-nan&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;1.#ind&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;1.#qnan&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;na&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;n/a&#39;</span><span class="p">,</span> <span class="s1">&#39;na&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;nan&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;null&#39;</span><span class="p">,]</span>
            <span class="n">condi</span> <span class="o">=</span> <span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">nan_list</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">condi</span> <span class="p">:</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">value</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">value</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">nan_clean</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">):</span> <span class="c1"># None or nan</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">space</span><span class="p">:</span> <span class="n">value</span> <span class="o">=</span> <span class="n">space_clean</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">end_dotzero</span><span class="p">:</span> <span class="n">value</span> <span class="o">=</span> <span class="n">end_dotzero_clean</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">nan</span><span class="p">:</span> <span class="n">value</span> <span class="o">=</span> <span class="n">nan_clean</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">punc</span><span class="p">:</span> <span class="n">value</span> <span class="o">=</span> <span class="n">punctuation_clean</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">use_unidecode</span><span class="p">:</span> <span class="n">value</span> <span class="o">=</span> <span class="n">unidecode</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="dataprep-clean-text">
<h3><span class="section-number">3.1.2. </span>Dataprep clean text<a class="headerlink" href="#dataprep-clean-text" title="Permalink to this heading">#</a></h3>
<p><a class="reference external" href="https://docs.dataprep.ai/user_guide/clean/clean_text.html">https://docs.dataprep.ai/user_guide/clean/clean_text.html</a></p>
<p>The default pipeline for the <code class="docutils literal notranslate"><span class="pre">clean_text()</span></code> function is the following:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fillna</span></code>: Replace all null values with NaN.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lowercase</span></code>: Convert all characters to lowercase.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">remove_digits</span></code>: Remove numbers.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">remove_html</span></code> Remove HTML tags.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">remove_urls</span></code>: Remove URLs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">remove_punctuation</span></code>: Remove punctuation marks.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">remove_accents</span></code>: Remove accent marks.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">remove_stopwords</span></code>: Remove stopwords.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">remove_whitespace</span></code>: Remove extra spaces, and tabs and newlines.</p></li>
</ul>
<p><strong>Note</strong>: neu warning <code class="docutils literal notranslate"><span class="pre">meta</span></code> in dask dataframe apply, sua trong <code class="docutils literal notranslate"><span class="pre">clean_text</span></code>(): <code class="docutils literal notranslate"><span class="pre">meta</span> <span class="pre">=</span> <span class="pre">object</span></code> –&gt; <code class="docutils literal notranslate"><span class="pre">meta</span> <span class="pre">=</span> <span class="pre">df[column]</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;&#39;ZZZZZ!&#39; If IMDb would allow one-word reviews, that&#39;s what mine would be.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;The cast played Shakespeare.&lt;br /&gt;&lt;br /&gt;Shakespeare lost.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Simon of the Desert (Simón del desierto) is a 1965 film directed by Luis Buñuel.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;[SPOILERS]</span><span class="se">\n</span><span class="s2">I don&#39;t think I&#39;ve seen a film this bad before {acting, script, effects (!), etc...}&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&lt;a href=&#39;/festivals/cannes-1968-a-video-essay&#39;&gt;Cannes 1968:</span><span class="se">\t</span><span class="s2">A video essay&lt;/a&gt;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Recap thread for @RottenTomatoes excellent panel, hosted by @ErikDavis with @FilmFatale_NYC and @AshCrossan.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#GameOfThrones: Season 8 is #Rotten at 54</span><span class="si">% o</span><span class="s2">n the #Tomatometer.  But does it deserve to be?&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Come join and share your thoughts on this week&#39;s episode: https://twitter.com/i/spaces/1fake2URL3&quot;</span><span class="p">,</span>
            <span class="mi">123</span><span class="p">,</span>
            <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
            <span class="s2">&quot;NULL&quot;</span><span class="p">,</span>
            <span class="s1">&#39;123.0&#39;</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>'ZZZZZ!' If IMDb would allow one-word reviews,...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>The cast played Shakespeare.&lt;br /&gt;&lt;br /&gt;Shakes...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Simon of the Desert (Simón del desierto) is a ...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>[SPOILERS]\nI don't think I've seen a film thi...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>&lt;a href='/festivals/cannes-1968-a-video-essay'...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Recap thread for @RottenTomatoes excellent pan...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>#GameOfThrones: Season 8 is #Rotten at 54% on ...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Come join and share your thoughts on this week...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>123</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10</th>
      <td>NULL</td>
    </tr>
    <tr>
      <th>11</th>
      <td>123.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dataprep.clean</span> <span class="kn">import</span> <span class="n">clean_text</span>
<span class="n">clean_text</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>zzzzz imdb would allow one word reviews mine w...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>cast played shakespeare shakespeare lost</td>
    </tr>
    <tr>
      <th>2</th>
      <td>simon desert simon del desierto film directed ...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>spoilers think seen film bad acting script eff...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>cannes video essay</td>
    </tr>
    <tr>
      <th>5</th>
      <td>recap thread rottentomatoes excellent panel ho...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>gameofthrones season rotten tomatometer deserve</td>
    </tr>
    <tr>
      <th>7</th>
      <td>come join share thoughts week episode</td>
    </tr>
    <tr>
      <th>8</th>
      <td></td>
    </tr>
    <tr>
      <th>9</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11</th>
      <td></td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># custom pipeline</span>
<span class="n">custom_pipeline</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;operator&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;operator_name&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;&lt;parameter_name&gt;&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;parameter_value&gt;&quot;</span><span class="p">},</span>
    <span class="p">}</span>
<span class="p">]</span>

<span class="kn">from</span> <span class="nn">dataprep.clean</span> <span class="kn">import</span> <span class="n">default_text_pipeline</span>
<span class="n">default_text_pipeline</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;operator&#39;: &#39;fillna&#39;},
 {&#39;operator&#39;: &#39;lowercase&#39;},
 {&#39;operator&#39;: &#39;remove_digits&#39;},
 {&#39;operator&#39;: &#39;remove_html&#39;},
 {&#39;operator&#39;: &#39;remove_urls&#39;},
 {&#39;operator&#39;: &#39;remove_punctuation&#39;},
 {&#39;operator&#39;: &#39;remove_accents&#39;},
 {&#39;operator&#39;: &#39;remove_stopwords&#39;, &#39;parameters&#39;: {&#39;stopwords&#39;: None}},
 {&#39;operator&#39;: &#39;remove_whitespace&#39;}]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># custom pipeline</span>

<span class="kn">import</span> <span class="nn">re</span>

<span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">replace_z</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">text</span><span class="p">),</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span>

<span class="n">custom_pipeline</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s2">&quot;operator&quot;</span><span class="p">:</span> <span class="s2">&quot;lowercase&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;operator&quot;</span><span class="p">:</span> <span class="s2">&quot;remove_digits&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;operator&quot;</span><span class="p">:</span> <span class="n">split</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;operator&quot;</span><span class="p">:</span> <span class="n">replace_z</span><span class="p">,</span> <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;*&quot;</span><span class="p">}},</span>
    <span class="p">{</span><span class="s2">&quot;operator&quot;</span><span class="p">:</span> <span class="s2">&quot;remove_whitespace&quot;</span><span class="p">},</span>
<span class="p">]</span>
<span class="n">clean_text</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">pipeline</span><span class="o">=</span><span class="n">custom_pipeline</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>["'*****!'", 'if', 'imdb', 'would', 'allow', '...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>['the', 'cast', 'played', 'shakespeare.&lt;br', '...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>['simon', 'of', 'the', 'desert', '(simón', 'de...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>['[spoilers]', 'i', "don't", 'think', "i've", ...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>['&lt;a', "href='/festivals/cannes--a-video-essay...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>['recap', 'thread', 'for', '@rottentomatoes', ...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>['#gameofthrones:', 'season', 'is', '#rotten',...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>['come', 'join', 'and', 'share', 'your', 'thou...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>[]</td>
    </tr>
    <tr>
      <th>9</th>
      <td>['nan']</td>
    </tr>
    <tr>
      <th>10</th>
      <td>['null']</td>
    </tr>
    <tr>
      <th>11</th>
      <td>['.']</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="address">
<h2><span class="section-number">3.2. </span>Address<a class="headerlink" href="#address" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">address</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;function với thông tin địa chỉ</span>

<span class="sd">    Returns:</span>
<span class="sd">        _type_: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">list_province</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;An Giang&#39;</span><span class="p">,</span> <span class="s1">&#39;Bà Rịa - Vũng Tàu&#39;</span><span class="p">,</span> <span class="s1">&#39;Bạc Liêu&#39;</span><span class="p">,</span> <span class="s1">&#39;Bắc Giang&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Bắc Kạn&#39;</span><span class="p">,</span> <span class="s1">&#39;Bắc Ninh&#39;</span><span class="p">,</span> <span class="s1">&#39;Bến Tre&#39;</span><span class="p">,</span> <span class="s1">&#39;Bình Dương&#39;</span><span class="p">,</span> <span class="s1">&#39;Bình Định&#39;</span><span class="p">,</span> <span class="s1">&#39;Bình Phước&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Bình Thuận&#39;</span><span class="p">,</span> <span class="s1">&#39;Cà Mau&#39;</span><span class="p">,</span> <span class="s1">&#39;Cao Bằng&#39;</span><span class="p">,</span> <span class="s1">&#39;Cần Thơ&#39;</span><span class="p">,</span> <span class="s1">&#39;Đà Nẵng&#39;</span><span class="p">,</span> <span class="s1">&#39;Đắk Lắk&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Đắk Nông&#39;</span><span class="p">,</span> <span class="s1">&#39;Điện Biên&#39;</span><span class="p">,</span> <span class="s1">&#39;Đồng Nai&#39;</span><span class="p">,</span> <span class="s1">&#39;Đồng Tháp&#39;</span><span class="p">,</span> <span class="s1">&#39;Gia Lai&#39;</span><span class="p">,</span> <span class="s1">&#39;Hà Giang&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Hà Nam&#39;</span><span class="p">,</span> <span class="s1">&#39;Hà Nội&#39;</span><span class="p">,</span> <span class="s1">&#39;Hà Tĩnh&#39;</span><span class="p">,</span> <span class="s1">&#39;Hải Dương&#39;</span><span class="p">,</span> <span class="s1">&#39;Hải Phòng&#39;</span><span class="p">,</span> <span class="s1">&#39;Hậu Giang&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Hòa Bình&#39;</span><span class="p">,</span> <span class="s1">&#39;Hưng Yên&#39;</span><span class="p">,</span> <span class="s1">&#39;Khánh Hòa&#39;</span><span class="p">,</span> <span class="s1">&#39;Kiên Giang&#39;</span><span class="p">,</span> <span class="s1">&#39;Kon Tum&#39;</span><span class="p">,</span> <span class="s1">&#39;Lai Châu&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Lạng Sơn&#39;</span><span class="p">,</span> <span class="s1">&#39;Lào Cai&#39;</span><span class="p">,</span> <span class="s1">&#39;Lâm Đồng&#39;</span><span class="p">,</span> <span class="s1">&#39;Long An&#39;</span><span class="p">,</span> <span class="s1">&#39;Nam Định&#39;</span><span class="p">,</span> <span class="s1">&#39;Nghệ An&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Ninh Bình&#39;</span><span class="p">,</span> <span class="s1">&#39;Ninh Thuận&#39;</span><span class="p">,</span> <span class="s1">&#39;Phú Thọ&#39;</span><span class="p">,</span> <span class="s1">&#39;Phú Yên&#39;</span><span class="p">,</span> <span class="s1">&#39;Quảng Bình&#39;</span><span class="p">,</span> <span class="s1">&#39;Quảng Nam&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Quảng Ngãi&#39;</span><span class="p">,</span> <span class="s1">&#39;Quảng Ninh&#39;</span><span class="p">,</span> <span class="s1">&#39;Quảng Trị&#39;</span><span class="p">,</span> <span class="s1">&#39;Sóc Trăng&#39;</span><span class="p">,</span> <span class="s1">&#39;Sơn La&#39;</span><span class="p">,</span> <span class="s1">&#39;Tây Ninh&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Thái Bình&#39;</span><span class="p">,</span> <span class="s1">&#39;Thái Nguyên&#39;</span><span class="p">,</span> <span class="s1">&#39;Thanh Hóa&#39;</span><span class="p">,</span> <span class="s1">&#39;Thành phố Hồ Chí Minh&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Thừa Thiên Huế&#39;</span><span class="p">,</span> <span class="s1">&#39;Tiền Giang&#39;</span><span class="p">,</span> <span class="s1">&#39;Trà Vinh&#39;</span><span class="p">,</span> <span class="s1">&#39;Tuyên Quang&#39;</span><span class="p">,</span> <span class="s1">&#39;Vĩnh Long&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Vĩnh Phúc&#39;</span><span class="p">,</span> <span class="s1">&#39;Yên Bái&#39;</span><span class="p">]</span>
    <span class="n">unidecode_province</span> <span class="o">=</span> <span class="p">{</span><span class="n">unidecode</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">list_province</span><span class="p">}</span>
    <span class="n">unidecode_province</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">unidecode</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">):</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">list_province</span><span class="p">})</span>
    <span class="n">unidecode_province</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;brvt&#39;</span><span class="p">:</span><span class="s1">&#39;Bà Rịa - Vũng Tàu&#39;</span><span class="p">,</span>
        <span class="s2">&quot;hn&quot;</span><span class="p">:</span><span class="s1">&#39;Hà Nội&#39;</span><span class="p">,</span><span class="s1">&#39;tphn&#39;</span><span class="p">:</span><span class="s1">&#39;Hà Nội&#39;</span><span class="p">,</span><span class="s1">&#39;ho chi minh&#39;</span><span class="p">:</span><span class="s1">&#39;Thành phố Hồ Chí Minh&#39;</span><span class="p">,</span>
        <span class="s1">&#39;hcm&#39;</span><span class="p">:</span> <span class="s1">&#39;Thành phố Hồ Chí Minh&#39;</span><span class="p">,</span> <span class="s1">&#39;ba ria vung tau&#39;</span><span class="p">:</span> <span class="s1">&#39;Bà Rịa - Vũng Tàu&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ba ria&#39;</span><span class="p">:</span> <span class="s1">&#39;Bà Rịa - Vũng Tàu&#39;</span><span class="p">,</span> <span class="s1">&#39;vung tau&#39;</span><span class="p">:</span> <span class="s1">&#39;Bà Rịa - Vũng Tàu&#39;</span><span class="p">,</span><span class="s1">&#39;hue&#39;</span><span class="p">:</span><span class="s1">&#39;Thừa Thiên Huế&#39;</span><span class="p">,</span>
        <span class="s1">&#39;daklak&#39;</span><span class="p">:</span><span class="s1">&#39;Đắk Lắk&#39;</span><span class="p">,</span> <span class="s1">&#39;daknong&#39;</span><span class="p">:</span><span class="s1">&#39;Đắk Nông&#39;</span><span class="p">,</span> <span class="s1">&#39;tphcm&#39;</span><span class="p">:</span> <span class="s1">&#39;Thành phố Hồ Chí Minh&#39;</span><span class="p">,</span>
        <span class="s1">&#39;bac can&#39;</span><span class="p">:</span> <span class="s1">&#39;Bắc Kạn&#39;</span><span class="p">,</span> <span class="s1">&#39;ha tay&#39;</span><span class="p">:</span><span class="s1">&#39;Hà Nội&#39;</span><span class="p">,</span><span class="s1">&#39;kontum&#39;</span><span class="p">:</span> <span class="s1">&#39;Kon Tum&#39;</span><span class="p">,</span>
    <span class="p">})</span>
    <span class="n">listkey</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">unidecode_province</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">get_province</span><span class="p">(</span><span class="n">address_data</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Xác định tỉnh thành từ địa chỉ</span>

<span class="sd">        Args:</span>
<span class="sd">            address_data (str): _description_</span>

<span class="sd">        Returns:</span>
<span class="sd">            _type_: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">address_data</span> <span class="o">!=</span> <span class="n">address_data</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">address_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="k">def</span> <span class="nf">rfind_nth</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">substring</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_num_char</span> <span class="o">=</span> <span class="mi">3</span><span class="p">):</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="n">substring</span><span class="p">)</span>
            <span class="k">while</span> <span class="n">end</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">end</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="n">substring</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
                <span class="n">n</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">string</span><span class="p">[</span><span class="n">end</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[:</span><span class="n">max_num_char</span><span class="p">])</span>

        <span class="n">add_replacepunc</span> <span class="o">=</span> <span class="n">address_data</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">maketrans</span><span class="p">(</span><span class="n">punctuation</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">punctuation</span><span class="p">)))</span> <span class="c1">#map punctuation to space</span>
        <span class="n">add_clean</span> <span class="o">=</span> <span class="n">unidecode</span><span class="p">(</span><span class="n">add_replacepunc</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">count_word_use</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
            <span class="n">check</span> <span class="o">=</span> <span class="n">rfind_nth</span><span class="p">(</span><span class="n">add_clean</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">count_word_use</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">minscore</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">]:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">get_close_matches</span><span class="p">(</span><span class="n">check</span><span class="p">,</span><span class="n">address</span><span class="o">.</span><span class="n">listkey</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="n">minscore</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">address</span><span class="o">.</span><span class="n">unidecode_province</span><span class="p">[</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>  
        <span class="c1"># return address.splitAdress(data = address_data, key_return = [&quot;province_short&quot;])[0]</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="datetime">
<h2><span class="section-number">3.3. </span>Datetime<a class="headerlink" href="#datetime" title="Permalink to this heading">#</a></h2>
<p><strong>Note</strong>: neu warning <code class="docutils literal notranslate"><span class="pre">meta</span></code> in dask dataframe apply, sua trong <code class="docutils literal notranslate"><span class="pre">clean_date</span></code>(): <code class="docutils literal notranslate"><span class="pre">meta</span> <span class="pre">=</span> <span class="pre">object</span></code> –&gt; <code class="docutils literal notranslate"><span class="pre">meta</span> <span class="pre">=</span> <span class="pre">df[column]</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;date&quot;</span><span class="p">:</span>
                   <span class="p">[</span><span class="s1">&#39;1996.07.10 AD at 15:08:56 PDT&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Thu Sep 25 10:36:28 2003&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Thu Sep 25 10:36:28 BRST 2003&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;2003 10:36:28 BRST 25 Sep Thu&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Thu Sep 25 10:36:28 2003&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Thu 10:36:28&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Thu 10:36&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;10:36&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Thu Sep 25 2003&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Sep 25 2003&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Sep 2003&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Sep&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;2003&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;2003-09-25&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;2003-Sep-25&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;25-Sep-2003&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Sep-25-2003&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;09-25-2003&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;10-09-2003&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;10-09-03&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;2003.Sep.25&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;2003/09/25&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;2003 Sep 25&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;2003 09 25&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;10pm&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;12:00am&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Sep 03&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Sep of 03&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Wed, July 10, 96&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;1996.07.10 AD at 15:08:56 PDT&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Tuesday, April 12, 1952 AD 3:30:42pm PST&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;November 5, 1994, 8:15:30 am EST&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;3rd of May 2001&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;5:50 AM on June 13, 1990&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;NULL&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;nan&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;I</span><span class="se">\&#39;</span><span class="s1">m a little cat&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;This is Sep.&#39;</span><span class="p">]})</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1996.07.10 AD at 15:08:56 PDT</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Thu Sep 25 10:36:28 2003</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Thu Sep 25 10:36:28 BRST 2003</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2003 10:36:28 BRST 25 Sep Thu</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Thu Sep 25 10:36:28 2003</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Thu 10:36:28</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Thu 10:36</td>
    </tr>
    <tr>
      <th>7</th>
      <td>10:36</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Thu Sep 25 2003</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Sep 25 2003</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Sep 2003</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Sep</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2003</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2003-09-25</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2003-Sep-25</td>
    </tr>
    <tr>
      <th>15</th>
      <td>25-Sep-2003</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Sep-25-2003</td>
    </tr>
    <tr>
      <th>17</th>
      <td>09-25-2003</td>
    </tr>
    <tr>
      <th>18</th>
      <td>10-09-2003</td>
    </tr>
    <tr>
      <th>19</th>
      <td>10-09-03</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2003.Sep.25</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2003/09/25</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2003 Sep 25</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2003 09 25</td>
    </tr>
    <tr>
      <th>24</th>
      <td>10pm</td>
    </tr>
    <tr>
      <th>25</th>
      <td>12:00am</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Sep 03</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Sep of 03</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Wed, July 10, 96</td>
    </tr>
    <tr>
      <th>29</th>
      <td>1996.07.10 AD at 15:08:56 PDT</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Tuesday, April 12, 1952 AD 3:30:42pm PST</td>
    </tr>
    <tr>
      <th>31</th>
      <td>November 5, 1994, 8:15:30 am EST</td>
    </tr>
    <tr>
      <th>32</th>
      <td>3rd of May 2001</td>
    </tr>
    <tr>
      <th>33</th>
      <td>5:50 AM on June 13, 1990</td>
    </tr>
    <tr>
      <th>34</th>
      <td>NULL</td>
    </tr>
    <tr>
      <th>35</th>
      <td>nan</td>
    </tr>
    <tr>
      <th>36</th>
      <td>I'm a little cat</td>
    </tr>
    <tr>
      <th>37</th>
      <td>This is Sep.</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dataprep.clean</span> <span class="kn">import</span> <span class="n">clean_date</span>
<span class="n">clean_date</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="s1">&#39;YYYY-MM-DD&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "43dcfe9008bd4942810c363f9ecd4196", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dates Cleaning Report:
	33 values cleaned (86.84%)
	2 values unable to be parsed (5.26%), set to NaN
Result contains 34 (89.47%) values in the correct format and 4 null values (10.53%)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>date_clean</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1996.07.10 AD at 15:08:56 PDT</td>
      <td>1996-07-10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Thu Sep 25 10:36:28 2003</td>
      <td>2003-09-25</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Thu Sep 25 10:36:28 BRST 2003</td>
      <td>2003-09-25</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2003 10:36:28 BRST 25 Sep Thu</td>
      <td>2003-09-25</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Thu Sep 25 10:36:28 2003</td>
      <td>2003-09-25</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Thu 10:36:28</td>
      <td>2000-01-01</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Thu 10:36</td>
      <td>2000-01-01</td>
    </tr>
    <tr>
      <th>7</th>
      <td>10:36</td>
      <td>2000-01-01</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Thu Sep 25 2003</td>
      <td>2003-09-25</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Sep 25 2003</td>
      <td>2003-09-25</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Sep 2003</td>
      <td>2003-09-01</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Sep</td>
      <td>2000-09-01</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2003</td>
      <td>2003-01-01</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2003-09-25</td>
      <td>2003-09-25</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2003-Sep-25</td>
      <td>2003-09-25</td>
    </tr>
    <tr>
      <th>15</th>
      <td>25-Sep-2003</td>
      <td>2003-09-25</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Sep-25-2003</td>
      <td>2003-09-25</td>
    </tr>
    <tr>
      <th>17</th>
      <td>09-25-2003</td>
      <td>2003-09-25</td>
    </tr>
    <tr>
      <th>18</th>
      <td>10-09-2003</td>
      <td>2003-10-09</td>
    </tr>
    <tr>
      <th>19</th>
      <td>10-09-03</td>
      <td>2003-10-09</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2003.Sep.25</td>
      <td>2003-09-25</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2003/09/25</td>
      <td>2003-09-25</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2003 Sep 25</td>
      <td>2003-09-25</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2003 09 25</td>
      <td>2003-09-25</td>
    </tr>
    <tr>
      <th>24</th>
      <td>10pm</td>
      <td>2000-01-01</td>
    </tr>
    <tr>
      <th>25</th>
      <td>12:00am</td>
      <td>2000-01-01</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Sep 03</td>
      <td>2003-09-01</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Sep of 03</td>
      <td>2003-09-01</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Wed, July 10, 96</td>
      <td>2096-07-10</td>
    </tr>
    <tr>
      <th>29</th>
      <td>1996.07.10 AD at 15:08:56 PDT</td>
      <td>1996-07-10</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Tuesday, April 12, 1952 AD 3:30:42pm PST</td>
      <td>1952-04-12</td>
    </tr>
    <tr>
      <th>31</th>
      <td>November 5, 1994, 8:15:30 am EST</td>
      <td>1994-11-05</td>
    </tr>
    <tr>
      <th>32</th>
      <td>3rd of May 2001</td>
      <td>2001-05-03</td>
    </tr>
    <tr>
      <th>33</th>
      <td>5:50 AM on June 13, 1990</td>
      <td>1990-06-13</td>
    </tr>
    <tr>
      <th>34</th>
      <td>NULL</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>35</th>
      <td>nan</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>36</th>
      <td>I'm a little cat</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>37</th>
      <td>This is Sep.</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="person-info">
<h2><span class="section-number">3.4. </span>Person info<a class="headerlink" href="#person-info" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Person</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Chuẩn hóa thông tin của người</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">gender_standardize</span><span class="p">(</span><span class="n">gender</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Chuẩn hóa giới tính&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">gender</span> <span class="o">!=</span> <span class="n">gender</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">gender</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">gender</span><span class="p">),</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">gender</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;male&#39;</span><span class="p">,</span><span class="s1">&#39;nam&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="s1">&#39;M&#39;</span>
        <span class="k">elif</span> <span class="n">gender</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;female&#39;</span><span class="p">,</span><span class="s1">&#39;nu&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="s1">&#39;F&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    
    <span class="k">def</span> <span class="nf">birthyear_standardize</span><span class="p">(</span><span class="n">birthyear</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Chuẩn hóa năm sinh</span>

<span class="sd">        Args:</span>
<span class="sd">            birthyear (_type_): _description_</span>

<span class="sd">        Returns:</span>
<span class="sd">            _type_: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">str_birthyear</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">birthyear</span><span class="p">),</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^[0-9]{4,4}$&quot;</span><span class="p">,</span><span class="n">str_birthyear</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">str_birthyear</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1930</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">str_birthyear</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2030</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">str_birthyear</span>
            <span class="k">return</span> <span class="n">res</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">res</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="idcard">
<h2><span class="section-number">3.5. </span>IDCard<a class="headerlink" href="#idcard" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">IDcard</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Đánh giá một chuỗi có phải là căn cước công dân hợp lệ hay không</span>
<span class="sd">    Các giá trị trả về:</span>
<span class="sd">    Type        Ý nghĩa                             Mô tả cách phân loại</span>
<span class="sd">    1           CMND                                9 ký tự số hợp lệ</span>
<span class="sd">    2           CMND 9 số có tỉnh                   9 ký tự số + 3 ký tự chữ ở cuối</span>
<span class="sd">    3           CCCD/CMND 12 số                     12 ký tự số hợp lệ</span>
<span class="sd">    4           Hộ chiếu VN                         Ký tự chữ ở đầu + 7 ký tự số ở cuối</span>
<span class="sd">    5           Hộ chiếu nước ngoài                 Có 8/9 ký tự, bao gồm cả ký tự chữ và số</span>
<span class="sd">    6           Nghi ngờ CMND mất 0                 8 ký tự số, khi thêm 0 được CMND hợp lệ</span>
<span class="sd">    7           Nghi ngờ CCCD/CMND 12 số mất 0      11 ký tự số, khi thêm 0 được CCCD/CMND 12 số hợp lệ</span>
<span class="sd">    8           Không hợp lệ                        Các trường hợp còn lại</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CCCDrule</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;001&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Hà Nội&quot;</span><span class="p">],</span>
    <span class="s2">&quot;002&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Hà Giang&quot;</span><span class="p">],</span>
    <span class="s2">&quot;004&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Cao Bằng&quot;</span><span class="p">],</span>
    <span class="s2">&quot;006&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Bắc Kạn&quot;</span><span class="p">],</span>
    <span class="s2">&quot;008&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Tuyên Quang&quot;</span><span class="p">],</span>
    <span class="s2">&quot;010&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Lào Cai&quot;</span><span class="p">],</span>
    <span class="s2">&quot;011&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Điện Biên&quot;</span><span class="p">],</span>
    <span class="s2">&quot;012&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Lai Châu&quot;</span><span class="p">],</span>
    <span class="s2">&quot;014&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Sơn La&quot;</span><span class="p">],</span>
    <span class="s2">&quot;015&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Yên Bái&quot;</span><span class="p">],</span>
    <span class="s2">&quot;017&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Hòa Bình&quot;</span><span class="p">],</span>
    <span class="s2">&quot;019&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Thái Nguyên&quot;</span><span class="p">],</span>
    <span class="s2">&quot;020&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Lạng Sơn&quot;</span><span class="p">],</span>
    <span class="s2">&quot;022&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Quảng Ninh&quot;</span><span class="p">],</span>
    <span class="s2">&quot;024&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Bắc Giang&quot;</span><span class="p">],</span>
    <span class="s2">&quot;025&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Phú Thọ&quot;</span><span class="p">],</span>
    <span class="s2">&quot;026&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Vĩnh Phúc&quot;</span><span class="p">],</span>
    <span class="s2">&quot;027&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Bắc Ninh&quot;</span><span class="p">],</span>
    <span class="s2">&quot;030&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Hải Dương&quot;</span><span class="p">],</span>
    <span class="s2">&quot;031&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Hải Phòng&quot;</span><span class="p">],</span>
    <span class="s2">&quot;033&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Hưng Yên&quot;</span><span class="p">],</span>
    <span class="s2">&quot;034&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Thái Bình&quot;</span><span class="p">],</span>
    <span class="s2">&quot;035&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Hà Nam&quot;</span><span class="p">],</span>
    <span class="s2">&quot;036&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Nam Định&quot;</span><span class="p">],</span>
    <span class="s2">&quot;037&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Ninh Bình&quot;</span><span class="p">],</span>
    <span class="s2">&quot;038&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Thanh Hóa&quot;</span><span class="p">],</span>
    <span class="s2">&quot;040&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Nghệ An&quot;</span><span class="p">],</span>
    <span class="s2">&quot;042&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Hà Tĩnh&quot;</span><span class="p">],</span>
    <span class="s2">&quot;044&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Quảng Bình&quot;</span><span class="p">],</span>
    <span class="s2">&quot;045&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Quảng Trị&quot;</span><span class="p">],</span>
    <span class="s2">&quot;046&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Thừa Thiên Huế&quot;</span><span class="p">],</span>
    <span class="s2">&quot;048&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Đà Nẵng&quot;</span><span class="p">],</span>
    <span class="s2">&quot;049&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Quảng Nam&quot;</span><span class="p">],</span>
    <span class="s2">&quot;051&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Quảng Ngãi&quot;</span><span class="p">],</span>
    <span class="s2">&quot;052&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Bình Định&quot;</span><span class="p">],</span>
    <span class="s2">&quot;054&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Phú Yên&quot;</span><span class="p">],</span>
    <span class="s2">&quot;056&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Khánh Hòa&quot;</span><span class="p">],</span>
    <span class="s2">&quot;058&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Ninh Thuận&quot;</span><span class="p">],</span>
    <span class="s2">&quot;060&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Bình Thuận&quot;</span><span class="p">],</span>
    <span class="s2">&quot;062&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Kon Tum&quot;</span><span class="p">],</span>
    <span class="s2">&quot;064&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Gia Lai&quot;</span><span class="p">],</span>
    <span class="s2">&quot;066&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Đắk Lắk&quot;</span><span class="p">],</span>
    <span class="s2">&quot;067&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Đắk Nông&quot;</span><span class="p">],</span>
    <span class="s2">&quot;068&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Lâm Đồng&quot;</span><span class="p">],</span>
    <span class="s2">&quot;070&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Bình Phước&quot;</span><span class="p">],</span>
    <span class="s2">&quot;072&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Tây Ninh&quot;</span><span class="p">],</span>
    <span class="s2">&quot;074&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Bình Dương&quot;</span><span class="p">],</span>
    <span class="s2">&quot;075&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Đồng Nai&quot;</span><span class="p">],</span>
    <span class="s2">&quot;077&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Bà Rịa - Vũng Tàu&quot;</span><span class="p">],</span>
    <span class="s2">&quot;079&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Hồ Chí Minh&quot;</span><span class="p">],</span>
    <span class="s2">&quot;080&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Long An&quot;</span><span class="p">],</span>
    <span class="s2">&quot;082&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Tiền Giang&quot;</span><span class="p">],</span>
    <span class="s2">&quot;083&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Bến Tre&quot;</span><span class="p">],</span>
    <span class="s2">&quot;084&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Trà Vinh&quot;</span><span class="p">],</span>
    <span class="s2">&quot;086&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Vĩnh Long&quot;</span><span class="p">],</span>
    <span class="s2">&quot;087&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Đồng Tháp&quot;</span><span class="p">],</span>
    <span class="s2">&quot;089&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;An Giang&quot;</span><span class="p">],</span>
    <span class="s2">&quot;091&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Kiên Giang&quot;</span><span class="p">],</span>
    <span class="s2">&quot;092&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Cần Thơ&quot;</span><span class="p">],</span>
    <span class="s2">&quot;093&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Hậu Giang&quot;</span><span class="p">],</span>
    <span class="s2">&quot;094&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Sóc Trăng&quot;</span><span class="p">],</span>
    <span class="s2">&quot;095&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Bạc Liêu&quot;</span><span class="p">],</span>
    <span class="s2">&quot;096&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Cà Mau&quot;</span><span class="p">],</span>
        <span class="p">}</span>
    <span class="c1"># Chứng minh nhân dân 9 số</span>
    <span class="n">CMNDrule</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;01&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Hà Nội&quot;</span><span class="p">],</span>
    <span class="s2">&quot;02&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Hồ Chí Minh&quot;</span><span class="p">],</span>
    <span class="s2">&quot;03&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Hải Phòng&quot;</span><span class="p">],</span>
    <span class="s2">&quot;04&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Điện Biên&quot;</span><span class="p">,</span> <span class="s2">&quot;Lai Châu&quot;</span><span class="p">],</span>
    <span class="s2">&quot;05&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Sơn La&quot;</span><span class="p">],</span>
    <span class="s2">&quot;06&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Lào Cai&quot;</span><span class="p">,</span> <span class="s2">&quot;Yên Bái&quot;</span><span class="p">],</span>
    <span class="s2">&quot;07&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Hà Giang&quot;</span><span class="p">,</span> <span class="s2">&quot;Tuyên Quang&quot;</span><span class="p">],</span>
    <span class="s2">&quot;08&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Lạng Sơn&quot;</span><span class="p">,</span> <span class="s2">&quot;Cao Bằng&quot;</span><span class="p">],</span>
    <span class="s2">&quot;090&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Thái Nguyên&quot;</span><span class="p">],</span>
    <span class="s2">&quot;091&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Thái Nguyên&quot;</span><span class="p">],</span>
    <span class="s2">&quot;092&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Thái Nguyên&quot;</span><span class="p">],</span>
    <span class="s2">&quot;095&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Bắc Kạn&quot;</span><span class="p">],</span>
    <span class="s2">&quot;10&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Quảng Ninh&quot;</span><span class="p">],</span>
    <span class="s2">&quot;11&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Hà Tây&quot;</span><span class="p">,</span> <span class="s2">&quot;Hòa Bình&quot;</span><span class="p">,</span> <span class="s2">&quot;Hà Nội&quot;</span><span class="p">],</span>
    <span class="s2">&quot;12&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Bắc Giang&quot;</span><span class="p">,</span> <span class="s2">&quot;Bắc Ninh&quot;</span><span class="p">],</span>
    <span class="s2">&quot;13&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Phú Thọ&quot;</span><span class="p">,</span> <span class="s2">&quot;Vĩnh Phúc&quot;</span><span class="p">],</span>
    <span class="s2">&quot;14&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Hải Dương&quot;</span><span class="p">,</span> <span class="s2">&quot;Hưng Yên&quot;</span><span class="p">],</span>
    <span class="s2">&quot;15&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Thái Bình&quot;</span><span class="p">],</span>
    <span class="s2">&quot;16&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Nam Định&quot;</span><span class="p">,</span> <span class="s2">&quot;Hà Nam&quot;</span><span class="p">,</span> <span class="s2">&quot;Ninh Bình&quot;</span><span class="p">],</span>
    <span class="s2">&quot;17&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Thanh Hóa&quot;</span><span class="p">],</span>
    <span class="s2">&quot;18&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Nghệ An&quot;</span><span class="p">,</span> <span class="s2">&quot;Hà Tĩnh&quot;</span><span class="p">],</span>
    <span class="s2">&quot;19&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Quảng Bình&quot;</span><span class="p">,</span> <span class="s2">&quot;Quảng Trị&quot;</span><span class="p">,</span> <span class="s2">&quot;Thừa Thiên - Huế&quot;</span><span class="p">],</span>
    <span class="s2">&quot;20&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Quảng Nam&quot;</span><span class="p">,</span> <span class="s2">&quot;Đà Nẵng&quot;</span><span class="p">],</span>
    <span class="s2">&quot;21&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Quảng Ngãi&quot;</span><span class="p">,</span> <span class="s2">&quot;Bình Định&quot;</span><span class="p">],</span>
    <span class="s2">&quot;22&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Khánh Hòa&quot;</span><span class="p">,</span> <span class="s2">&quot;Phú Yên&quot;</span><span class="p">],</span>
    <span class="s2">&quot;230&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Gia Lai&quot;</span><span class="p">],</span>
    <span class="s2">&quot;231&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Gia Lai&quot;</span><span class="p">],</span>
    <span class="s2">&quot;23&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Kon Tum&quot;</span><span class="p">],</span>
    <span class="s2">&quot;24&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Đắk Lắk&quot;</span><span class="p">],</span>
    <span class="s2">&quot;245&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Đắk Nông&quot;</span><span class="p">],</span>
    <span class="s2">&quot;25&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Lâm Đồng&quot;</span><span class="p">],</span>
    <span class="s2">&quot;26&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Ninh Thuận&quot;</span><span class="p">,</span> <span class="s2">&quot;Bình Thuận&quot;</span><span class="p">],</span>
    <span class="s2">&quot;27&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Đồng Nai&quot;</span><span class="p">,</span> <span class="s2">&quot;Bà Rịa - Vũng Tàu&quot;</span><span class="p">],</span>
    <span class="s2">&quot;280&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Bình Dương&quot;</span><span class="p">],</span>
    <span class="s2">&quot;281&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Bình Dương&quot;</span><span class="p">],</span>
    <span class="s2">&quot;285&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Bình Phước&quot;</span><span class="p">],</span>
    <span class="s2">&quot;29&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Tây Ninh&quot;</span><span class="p">],</span>
    <span class="s2">&quot;30&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Long An&quot;</span><span class="p">],</span>
    <span class="s2">&quot;31&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Tiền Giang&quot;</span><span class="p">],</span>
    <span class="s2">&quot;32&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Bến Tre&quot;</span><span class="p">],</span>
    <span class="s2">&quot;33&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Vĩnh Long&quot;</span><span class="p">,</span> <span class="s2">&quot;Trà Vinh&quot;</span><span class="p">],</span>
    <span class="s2">&quot;34&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Đồng Tháp&quot;</span><span class="p">],</span>
    <span class="s2">&quot;35&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;An Giang&quot;</span><span class="p">],</span>
    <span class="s2">&quot;36&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Cần Thơ&quot;</span><span class="p">,</span> <span class="s2">&quot;Hậu Giang&quot;</span><span class="p">,</span> <span class="s2">&quot;Sóc Trăng&quot;</span><span class="p">],</span>
    <span class="s2">&quot;37&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Kiên Giang&quot;</span><span class="p">],</span>
    <span class="s2">&quot;38&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Cà Mau&quot;</span><span class="p">,</span> <span class="s2">&quot;Bạc Liêu&quot;</span><span class="p">],</span>
        <span class="p">}</span>
    <span class="n">typeError</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;1&#39;</span><span class="p">:</span> <span class="s2">&quot;CMND&quot;</span><span class="p">,</span> 
    <span class="s1">&#39;2&#39;</span><span class="p">:</span> <span class="s2">&quot;CMND 9 số có tỉnh&quot;</span><span class="p">,</span> 
    <span class="s1">&#39;3&#39;</span><span class="p">:</span> <span class="s2">&quot;CCCD/CMND 12 số&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;4&quot;</span><span class="p">:</span> <span class="s2">&quot;Hộ chiếu VN&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;5&quot;</span><span class="p">:</span> <span class="s2">&quot;Hộ chiếu nước ngoài&quot;</span><span class="p">,</span>
    <span class="s2">&quot;6&quot;</span><span class="p">:</span> <span class="s2">&quot;Nghi ngờ CMND mất 0&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;7&quot;</span><span class="p">:</span> <span class="s2">&quot;Nghi ngờ CCCD/CMND 12 số mất 0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;8&quot;</span><span class="p">:</span> <span class="s2">&quot;Không hợp lệ&quot;</span>
        <span class="p">}</span>
    <span class="n">typeStandard</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;1&quot;</span><span class="p">:</span> <span class="s2">&quot;PASSPORT_VN&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;2&quot;</span><span class="p">:</span> <span class="s2">&quot;PASSPORT_NN&quot;</span><span class="p">,</span>
    <span class="s2">&quot;3&quot;</span><span class="p">:</span> <span class="s2">&quot;CMND_9&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;4&quot;</span><span class="p">:</span> <span class="s2">&quot;CCCD_12&quot;</span><span class="p">,</span>
    <span class="s2">&quot;5&quot;</span><span class="p">:</span> <span class="s2">&quot;unknown&quot;</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">cleankey</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">error</span> <span class="o">=</span> <span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Làm sạch input</span>

<span class="sd">        Args:</span>
<span class="sd">            error (str, optional): _description_. Defaults to &#39;ignore&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            _type_: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">cleaned</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cleaned</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">cleaned</span> <span class="o">!=</span> <span class="n">cleaned</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="n">runtime</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">while</span> <span class="p">(</span><span class="nb">len</span><span class="p">([</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">cleaned</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()])</span> <span class="o">&gt;</span> <span class="mi">12</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">runtime</span> <span class="o">&lt;</span><span class="mi">30</span><span class="p">):</span>
                <span class="n">runtime</span><span class="o">+=</span><span class="mi">1</span>
                <span class="k">if</span> <span class="n">cleaned</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span><span class="p">:</span>
                    <span class="n">cleaned</span> <span class="o">=</span> <span class="n">cleaned</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">continue</span>

            <span class="k">if</span> <span class="n">runtime</span> <span class="o">==</span> <span class="mi">30</span><span class="p">:</span>
                <span class="k">raise</span>

            <span class="n">res</span> <span class="o">=</span> <span class="n">cleaned</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">error</span> <span class="o">==</span> <span class="s1">&#39;ignore&#39;</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
            <span class="k">if</span> <span class="n">error</span> <span class="o">==</span> <span class="s1">&#39;nan&#39;</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">return</span> <span class="n">res</span>


    <span class="k">def</span> <span class="nf">typeIDcode</span><span class="p">(</span><span class="bp">self</span><span class="p">,):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Trả ra mã code của ID theo nhóm</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">isAllNumber</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
            <span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">char</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">():</span>
                    <span class="k">return</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="kc">True</span> 

        <span class="k">def</span> <span class="nf">isAllAlpha</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
            <span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">char</span><span class="o">.</span><span class="n">isalpha</span><span class="p">():</span>
                    <span class="k">return</span> <span class="kc">False</span> 
            <span class="k">return</span> <span class="kc">True</span> 

        <span class="k">def</span> <span class="nf">is9IDCard</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">text</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="ow">in</span> <span class="n">IDcard</span><span class="o">.</span><span class="n">CMNDrule</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">or</span> <span class="n">text</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="ow">in</span> <span class="n">IDcard</span><span class="o">.</span><span class="n">CMNDrule</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">def</span> <span class="nf">is12IDCard</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">text</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">IDcard</span><span class="o">.</span><span class="n">CCCDrule</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="c1"># Sai ma tinh </span>
                <span class="k">return</span> <span class="kc">False</span> 
            <span class="k">elif</span> <span class="nb">int</span><span class="p">(</span><span class="n">text</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span> <span class="c1"># ?</span>
                <span class="c1"># print(&quot;Sai gioi tinh&quot;)</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="nb">int</span><span class="p">(</span><span class="n">text</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">text</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">25</span><span class="p">:</span>
                <span class="c1"># sinh năm &gt;= 2000 và năm sinh &gt;= 2025</span>
                <span class="c1"># print(&quot;Sai nam sinh&quot;)</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="kc">True</span> 
        
        <span class="k">def</span> <span class="nf">get_codetypeID</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">isAllAlpha</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
                <span class="c1"># Chỉ chứa ký tự chữ </span>
                <span class="k">return</span> <span class="s2">&quot;8&quot;</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">==</span> <span class="mi">12</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">isAllNumber</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">is12IDCard</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
                    <span class="c1"># &quot;CCCD/CMND 12 số: 12 ký tự số hợp lệ&quot;,</span>
                        <span class="k">return</span> <span class="s1">&#39;3&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">return</span> <span class="s1">&#39;8&#39;</span>
                <span class="k">elif</span> <span class="n">isAllNumber</span><span class="p">(</span><span class="n">text</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">9</span><span class="p">])</span> <span class="ow">and</span> <span class="n">is9IDCard</span><span class="p">(</span><span class="n">text</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">9</span><span class="p">])</span> <span class="ow">and</span> <span class="n">isAllAlpha</span><span class="p">(</span><span class="n">text</span><span class="p">[</span><span class="mi">9</span><span class="p">:</span><span class="mi">12</span><span class="p">]):</span>
                    <span class="c1"># CMND 9 số có tỉnh: 9 ký tự số + 3 ký tự chữ ở cuối</span>
                    <span class="k">return</span> <span class="s1">&#39;2&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;8&#39;</span>

            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">==</span> <span class="mi">11</span> <span class="ow">and</span> <span class="n">isAllNumber</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">is12IDCard</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="o">+</span><span class="n">text</span><span class="p">)</span> <span class="p">:</span>
                <span class="c1"># Nghi ngờ CCCD/CMND 12 số mất 0: 11 ký tự số, khi thêm 0 được CCCD/CMND 12 số hợp lệ</span>
                    <span class="k">return</span> <span class="s1">&#39;7&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;8&#39;</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span> <span class="ow">and</span> <span class="n">isAllNumber</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">is12IDCard</span><span class="p">(</span><span class="s2">&quot;00&quot;</span><span class="o">+</span><span class="n">text</span><span class="p">)</span> <span class="p">:</span>
                <span class="c1"># Nghi ngờ CCCD/CMND 12 số mất 0: 11 ký tự số, khi thêm 0 được CCCD/CMND 12 số hợp lệ</span>
                    <span class="k">return</span> <span class="s1">&#39;7&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;8&#39;</span>

            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;[a-zA-Z][0-9]</span><span class="si">{7}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
                    <span class="c1"># Hộ chiếu VN: Ký tự chữ ở đầu + 7 ký tự số ở cuối</span>
                    <span class="k">return</span> <span class="s1">&#39;4&#39;</span>
                <span class="k">elif</span> <span class="n">isAllNumber</span><span class="p">(</span><span class="n">text</span><span class="p">):</span> 
                    <span class="k">if</span> <span class="n">is9IDCard</span><span class="p">(</span><span class="s2">&quot;0&quot;</span> <span class="o">+</span> <span class="n">text</span><span class="p">)</span> <span class="p">:</span>
                    <span class="c1"># Nghi ngờ CMND mất 0: 8 ký tự số, khi thêm 0 được CMND hợp lệ</span>
                        <span class="k">return</span> <span class="s1">&#39;6&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># 8 ký tự số, vẫn sai khi thêm 0</span>
                        <span class="k">return</span> <span class="s2">&quot;8&quot;</span><span class="c1">#&quot;6a&quot;</span>
                <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;[a-zA-Z0-9]</span><span class="si">{8}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
                    <span class="k">return</span> <span class="s2">&quot;5&quot;</span><span class="c1">#&quot;5a&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;8&#39;</span>

            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">isAllNumber</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">is9IDCard</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
                    <span class="c1"># CMND: 9 ký tự số hợp lệ</span>
                        <span class="k">return</span> <span class="s1">&#39;1&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># 9 ký tự số, sai mã tỉnh </span>
                        <span class="k">return</span> <span class="s2">&quot;8&quot;</span><span class="c1">#&quot;1a&quot; </span>
                <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;[a-zA-Z0-9]</span><span class="si">{9}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
                    <span class="k">return</span> <span class="s2">&quot;5&quot;</span><span class="c1">#&quot;5b&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;8&#39;</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;8&#39;</span>

        <span class="k">return</span> <span class="n">get_codetypeID</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cleankey</span><span class="p">())</span>
    
    <span class="k">def</span> <span class="nf">typeIDraw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Trả ra type of ID raw</span>

<span class="sd">        Returns:</span>
<span class="sd">            _type_: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">IDcard</span><span class="o">.</span><span class="n">typeError</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">typeIDcode</span><span class="p">()]</span>

    <span class="k">def</span> <span class="nf">typeIDstandard</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">error</span> <span class="o">=</span> <span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Trả ra type of ID sau khi chuẩn hóa</span>

<span class="sd">        Args:</span>
<span class="sd">            error (str, optional): _description_. Defaults to &#39;ignore&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            _type_: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">value</span> <span class="o">!=</span> <span class="n">value</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">value</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">checkvalue</span> <span class="o">=</span> <span class="n">unidecode</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;pp&#39;</span><span class="p">,</span><span class="s1">&#39;passport&#39;</span><span class="p">,</span> <span class="s1">&#39;hochieu&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">checkvalue</span> <span class="p">])</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;PASSPORT&#39;</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;cccd&#39;</span><span class="p">,</span><span class="s1">&#39;cmnd12&#39;</span><span class="p">,</span> <span class="s1">&#39;cc&#39;</span><span class="p">,</span><span class="s1">&#39;chip&#39;</span><span class="p">,</span> <span class="s1">&#39;cancuoccongdan&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">checkvalue</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">IDcard</span><span class="o">.</span><span class="n">typeStandard</span><span class="p">[</span><span class="s1">&#39;4&#39;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;cmnd&#39;</span><span class="p">,</span><span class="s1">&#39;cmt&#39;</span><span class="p">,</span><span class="s1">&#39;chungminhthu&#39;</span><span class="p">,</span><span class="s1">&#39;chungminhnhandan&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()])</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">IDcard</span><span class="o">.</span><span class="n">typeStandard</span><span class="p">[</span><span class="s1">&#39;3&#39;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">error</span> <span class="o">==</span> <span class="s1">&#39;ignore&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cleaned</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleankey</span><span class="p">(</span><span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cleaned</span> <span class="o">!=</span> <span class="n">cleaned</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="n">typeID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">typeIDcode</span><span class="p">()</span>
            <span class="k">if</span> <span class="p">((</span><span class="n">typeID</span> <span class="o">==</span><span class="s1">&#39;3&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cleaned</span><span class="p">)</span> <span class="o">==</span> <span class="mi">12</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="n">typeID</span> <span class="o">==</span><span class="s1">&#39;7&#39;</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">IDcard</span><span class="o">.</span><span class="n">typeStandard</span><span class="p">[</span><span class="s1">&#39;4&#39;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">typeID</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;6&#39;</span><span class="p">])</span> <span class="ow">or</span> <span class="p">((</span><span class="n">typeID</span> <span class="o">==</span><span class="s1">&#39;3&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cleaned</span><span class="p">)</span> <span class="o">==</span> <span class="mi">9</span><span class="p">)):</span>
                <span class="k">return</span> <span class="n">IDcard</span><span class="o">.</span><span class="n">typeStandard</span><span class="p">[</span><span class="s1">&#39;3&#39;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="p">(</span> <span class="n">typeID</span> <span class="o">==</span><span class="s1">&#39;4&#39;</span> <span class="p">):</span>
                <span class="k">return</span> <span class="n">IDcard</span><span class="o">.</span><span class="n">typeStandard</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="p">(</span> <span class="n">typeID</span> <span class="o">==</span><span class="s1">&#39;5&#39;</span> <span class="p">):</span>
                <span class="k">return</span> <span class="n">IDcard</span><span class="o">.</span><span class="n">typeStandard</span><span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">IDcard</span><span class="o">.</span><span class="n">typeStandard</span><span class="p">[</span><span class="s1">&#39;5&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">standardize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">error</span> <span class="o">=</span> <span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Hàm chuẩn hóa ID</span>

<span class="sd">        Args:</span>
<span class="sd">            error (str, optional): _description_. Defaults to &#39;ignore&#39;.</span>
<span class="sd">            encrypt (bool, optional): _description_. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            _type_: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cleaned</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleankey</span><span class="p">(</span><span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
        <span class="n">cleaned</span> <span class="o">=</span> <span class="n">cleaned</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">cleaned</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span> <span class="k">else</span> <span class="n">cleaned</span>
        <span class="n">typeID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">typeIDcode</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">typeID</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;4&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">]):</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">cleaned</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">typeID</span> <span class="o">==</span> <span class="s1">&#39;2&#39;</span><span class="p">):</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">cleaned</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">typeID</span> <span class="o">==</span> <span class="s1">&#39;6&#39;</span><span class="p">):</span>
            <span class="n">res</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:09.0f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">cleaned</span><span class="p">))</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">typeID</span> <span class="o">==</span> <span class="s1">&#39;7&#39;</span><span class="p">):</span>
            <span class="n">res</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:012.0f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">cleaned</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">cleaned</span>

        <span class="k">return</span> <span class="n">res</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="phone-number">
<h2><span class="section-number">3.6. </span>Phone number<a class="headerlink" href="#phone-number" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Phone</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Lấy thông tin từ 1 số điện thoại</span>

<span class="sd">    Args:</span>
<span class="sd">        text (_type_): _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">dialcode</span> <span class="o">=</span> <span class="s2">&quot;84&quot;</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dialcode</span> <span class="o">=</span> <span class="n">dialcode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">error</span> <span class="o">=</span> <span class="n">error</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chuyendausodidong</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span><span class="s1">&#39;162&#39;</span><span class="p">,</span><span class="s1">&#39;32&#39;</span><span class="p">],[</span><span class="s1">&#39;163&#39;</span><span class="p">,</span><span class="s1">&#39;33&#39;</span><span class="p">],[</span><span class="s1">&#39;164&#39;</span><span class="p">,</span><span class="s1">&#39;34&#39;</span><span class="p">],[</span><span class="s1">&#39;165&#39;</span><span class="p">,</span><span class="s1">&#39;35&#39;</span><span class="p">],[</span><span class="s1">&#39;166&#39;</span><span class="p">,</span><span class="s1">&#39;36&#39;</span><span class="p">],[</span><span class="s1">&#39;167&#39;</span><span class="p">,</span><span class="s1">&#39;37&#39;</span><span class="p">],[</span><span class="s1">&#39;168&#39;</span><span class="p">,</span><span class="s1">&#39;38&#39;</span><span class="p">],[</span><span class="s1">&#39;169&#39;</span><span class="p">,</span><span class="s1">&#39;39&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;120&#39;</span><span class="p">,</span><span class="s1">&#39;70&#39;</span><span class="p">],[</span><span class="s1">&#39;121&#39;</span><span class="p">,</span><span class="s1">&#39;79&#39;</span><span class="p">],[</span><span class="s1">&#39;122&#39;</span><span class="p">,</span><span class="s1">&#39;77&#39;</span><span class="p">],[</span><span class="s1">&#39;126&#39;</span><span class="p">,</span><span class="s1">&#39;76&#39;</span><span class="p">],[</span><span class="s1">&#39;128&#39;</span><span class="p">,</span><span class="s1">&#39;78&#39;</span><span class="p">],[</span><span class="s1">&#39;123&#39;</span><span class="p">,</span><span class="s1">&#39;83&#39;</span><span class="p">],[</span><span class="s1">&#39;124&#39;</span><span class="p">,</span><span class="s1">&#39;84&#39;</span><span class="p">],[</span><span class="s1">&#39;125&#39;</span><span class="p">,</span><span class="s1">&#39;85&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;127&#39;</span><span class="p">,</span><span class="s1">&#39;81&#39;</span><span class="p">],[</span><span class="s1">&#39;129&#39;</span><span class="p">,</span><span class="s1">&#39;82&#39;</span><span class="p">],[</span><span class="s1">&#39;182&#39;</span><span class="p">,</span><span class="s1">&#39;52&#39;</span><span class="p">],[</span><span class="s1">&#39;186&#39;</span><span class="p">,</span><span class="s1">&#39;56&#39;</span><span class="p">],[</span><span class="s1">&#39;188&#39;</span><span class="p">,</span><span class="s1">&#39;58&#39;</span><span class="p">],[</span><span class="s1">&#39;199&#39;</span><span class="p">,</span><span class="s1">&#39;59&#39;</span><span class="p">]</span>
            <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chuyendausocodinh</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span><span class="s1">&#39;76&#39;</span><span class="p">,</span> <span class="s1">&#39;296&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;64&#39;</span><span class="p">,</span> <span class="s1">&#39;254&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;281&#39;</span><span class="p">,</span> <span class="s1">&#39;209&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;240&#39;</span><span class="p">,</span> <span class="s1">&#39;204&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;781&#39;</span><span class="p">,</span> <span class="s1">&#39;291&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;241&#39;</span><span class="p">,</span> <span class="s1">&#39;222&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;75&#39;</span><span class="p">,</span> <span class="s1">&#39;275&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;56&#39;</span><span class="p">,</span> <span class="s1">&#39;256&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;650&#39;</span><span class="p">,</span> <span class="s1">&#39;274&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;651&#39;</span><span class="p">,</span> <span class="s1">&#39;271&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;62&#39;</span><span class="p">,</span> <span class="s1">&#39;252&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;780&#39;</span><span class="p">,</span> <span class="s1">&#39;290&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;710&#39;</span><span class="p">,</span> <span class="s1">&#39;292&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;26&#39;</span><span class="p">,</span> <span class="s1">&#39;206&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;511&#39;</span><span class="p">,</span> <span class="s1">&#39;236&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;500&#39;</span><span class="p">,</span> <span class="s1">&#39;262&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;501&#39;</span><span class="p">,</span> <span class="s1">&#39;261&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;230&#39;</span><span class="p">,</span> <span class="s1">&#39;215&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;61&#39;</span><span class="p">,</span> <span class="s1">&#39;251&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;67&#39;</span><span class="p">,</span> <span class="s1">&#39;277&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;59&#39;</span><span class="p">,</span> <span class="s1">&#39;269&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;219&#39;</span><span class="p">,</span> <span class="s1">&#39;219&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;351&#39;</span><span class="p">,</span> <span class="s1">&#39;226&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;24&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;39&#39;</span><span class="p">,</span> <span class="s1">&#39;239&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;320&#39;</span><span class="p">,</span> <span class="s1">&#39;220&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;31&#39;</span><span class="p">,</span> <span class="s1">&#39;225&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;711&#39;</span><span class="p">,</span> <span class="s1">&#39;293&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;8&#39;</span><span class="p">,</span> <span class="s1">&#39;28&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;218&#39;</span><span class="p">,</span> <span class="s1">&#39;218&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;321&#39;</span><span class="p">,</span> <span class="s1">&#39;221&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;8&#39;</span><span class="p">,</span> <span class="s1">&#39;258&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;77&#39;</span><span class="p">,</span> <span class="s1">&#39;297&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;60&#39;</span><span class="p">,</span> <span class="s1">&#39;260&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;231&#39;</span><span class="p">,</span> <span class="s1">&#39;213&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;63&#39;</span><span class="p">,</span> <span class="s1">&#39;263&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;25&#39;</span><span class="p">,</span> <span class="s1">&#39;205&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;20&#39;</span><span class="p">,</span> <span class="s1">&#39;214&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;72&#39;</span><span class="p">,</span> <span class="s1">&#39;272&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;350&#39;</span><span class="p">,</span> <span class="s1">&#39;228&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;38&#39;</span><span class="p">,</span> <span class="s1">&#39;238&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;30&#39;</span><span class="p">,</span> <span class="s1">&#39;229&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;68&#39;</span><span class="p">,</span> <span class="s1">&#39;259&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;210&#39;</span><span class="p">,</span> <span class="s1">&#39;210&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;57&#39;</span><span class="p">,</span> <span class="s1">&#39;257&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;52&#39;</span><span class="p">,</span> <span class="s1">&#39;232&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;510&#39;</span><span class="p">,</span> <span class="s1">&#39;235&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;55&#39;</span><span class="p">,</span> <span class="s1">&#39;255&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;33&#39;</span><span class="p">,</span> <span class="s1">&#39;203&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;53&#39;</span><span class="p">,</span> <span class="s1">&#39;233&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;79&#39;</span><span class="p">,</span> <span class="s1">&#39;299&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;22&#39;</span><span class="p">,</span> <span class="s1">&#39;212&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;66&#39;</span><span class="p">,</span> <span class="s1">&#39;276&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;36&#39;</span><span class="p">,</span> <span class="s1">&#39;227&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;280&#39;</span><span class="p">,</span> <span class="s1">&#39;208&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;37&#39;</span><span class="p">,</span> <span class="s1">&#39;237&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;54&#39;</span><span class="p">,</span> <span class="s1">&#39;234&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;73&#39;</span><span class="p">,</span> <span class="s1">&#39;273&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;74&#39;</span><span class="p">,</span> <span class="s1">&#39;294&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;27&#39;</span><span class="p">,</span> <span class="s1">&#39;207&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;70&#39;</span><span class="p">,</span> <span class="s1">&#39;270&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;211&#39;</span><span class="p">,</span> <span class="s1">&#39;211&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;29&#39;</span><span class="p">,</span> <span class="s1">&#39;216&#39;</span><span class="p">],</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dausodidong</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">chuyendausodidong</span><span class="p">]</span> <span class="o">+</span> \
                            <span class="p">[</span><span class="s1">&#39;86&#39;</span><span class="p">,</span><span class="s1">&#39;96&#39;</span><span class="p">,</span><span class="s1">&#39;97&#39;</span><span class="p">,</span><span class="s1">&#39;98&#39;</span><span class="p">,</span><span class="s1">&#39;88&#39;</span><span class="p">,</span><span class="s1">&#39;91&#39;</span><span class="p">,</span><span class="s1">&#39;94&#39;</span><span class="p">,</span><span class="s1">&#39;89&#39;</span><span class="p">,</span><span class="s1">&#39;90&#39;</span><span class="p">,</span><span class="s1">&#39;93&#39;</span><span class="p">,</span><span class="s1">&#39;92&#39;</span><span class="p">,</span><span class="s1">&#39;56&#39;</span><span class="p">,</span><span class="s1">&#39;58&#39;</span><span class="p">,</span><span class="s1">&#39;99&#39;</span><span class="p">,</span><span class="s1">&#39;87&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dausocodinh</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">chuyendausocodinh</span><span class="p">]</span>
        <span class="c1"># self.typephone = &#39;unknown&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cleaned</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">cleankey</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Hàm làm sạch input</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: _description_</span>

<span class="sd">        Returns:</span>
<span class="sd">            _type_: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">typephone</span> <span class="o">=</span> <span class="s1">&#39;unknown&#39;</span>
        <span class="n">dialcode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialcode</span>
        <span class="k">def</span> <span class="nf">isAllNumber</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">char</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">():</span>
                    <span class="k">return</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="kc">True</span> 
        <span class="n">cleaned</span> <span class="o">=</span>  <span class="n">text</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">isAllNumber</span><span class="p">(</span><span class="n">cleaned</span><span class="p">)</span>

        <span class="n">runtime</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">while</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cleaned</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">runtime</span><span class="o">&lt;</span><span class="mi">30</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">typephone</span> <span class="o">==</span> <span class="s1">&#39;unknown&#39;</span><span class="p">):</span>

            <span class="n">cleaned</span> <span class="o">=</span> <span class="n">cleaned</span><span class="p">[</span><span class="mi">5</span><span class="p">:]</span> <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;8400[0-9]{1,1}&#39;</span><span class="p">,</span><span class="n">cleaned</span><span class="p">[:</span><span class="mi">5</span><span class="p">]))</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cleaned</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">14</span><span class="p">)</span> <span class="k">else</span> <span class="n">cleaned</span>
            <span class="n">cleaned</span> <span class="o">=</span> <span class="n">cleaned</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="k">if</span> <span class="n">cleaned</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span> <span class="k">else</span> <span class="n">cleaned</span>
            <span class="k">if</span> <span class="p">((</span><span class="n">cleaned</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">dialcode</span><span class="p">)]</span> <span class="o">==</span> <span class="n">dialcode</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">cleaned</span><span class="p">)</span><span class="o">&gt;=</span><span class="p">(</span><span class="mi">9</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">dialcode</span><span class="p">))):</span>
                <span class="n">cleaned</span> <span class="o">=</span> <span class="n">cleaned</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">dialcode</span><span class="p">):]</span>

            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cleaned</span><span class="p">)</span> <span class="o">==</span> <span class="mi">9</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">typephone</span> <span class="o">==</span> <span class="s1">&#39;unknown&#39;</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dausodidong</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">cleaned</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">typephone</span> <span class="o">=</span> <span class="s1">&#39;so_di_dong&#39;</span>
                        <span class="k">break</span>

            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cleaned</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">typephone</span> <span class="o">==</span> <span class="s1">&#39;unknown&#39;</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dausocodinh</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">cleaned</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cleaned</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">):])</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">]):</span> <span class="c1"># ví du 0220 3736 596 (HD), 024 392 63087 (HN)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">typephone</span> <span class="o">=</span> <span class="s1">&#39;so_co_dinh&#39;</span>
                        <span class="k">break</span>
                    

            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cleaned</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">typephone</span> <span class="o">==</span> <span class="s1">&#39;unknown&#39;</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">chuyendausodidong</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">cleaned</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                        <span class="n">cleaned</span> <span class="o">=</span> <span class="n">cleaned</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">typephone</span> <span class="o">=</span> <span class="s1">&#39;so_di_dong&#39;</span>
                        <span class="k">break</span>

            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cleaned</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">typephone</span> <span class="o">==</span> <span class="s1">&#39;unknown&#39;</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">chuyendausocodinh</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">cleaned</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cleaned</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]):])</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">]):</span> <span class="c1"># ví du 0220 3736 596 (HD), 024 392 63087 (HN)</span>
                        <span class="n">cleaned</span> <span class="o">=</span> <span class="n">cleaned</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">typephone</span> <span class="o">=</span> <span class="s1">&#39;so_co_dinh&#39;</span>
                        <span class="k">break</span>

            <span class="n">runtime</span><span class="o">+=</span><span class="mi">1</span>

        <span class="k">if</span> <span class="n">runtime</span> <span class="o">==</span> <span class="mi">30</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cleaned</span>

    <span class="k">def</span> <span class="nf">standardize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Hàm chuẩn hóa SĐT</span>

<span class="sd">        Returns:</span>
<span class="sd">            _type_: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialcode</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleankey</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">error</span> <span class="o">==</span> <span class="s1">&#39;ignore&#39;</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">error</span> <span class="o">==</span> <span class="s1">&#39;nan&#39;</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="k">return</span> <span class="n">res</span>

    <span class="k">def</span> <span class="nf">pay_type</span><span class="p">(</span><span class="n">paytype</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Hàm chuẩn hóa thông tin paytype</span>

<span class="sd">        Args:</span>
<span class="sd">            paytype (_type_): _description_</span>

<span class="sd">        Returns:</span>
<span class="sd">            _type_: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">paytype</span> <span class="o">!=</span> <span class="n">paytype</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">paytype</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">paytype</span><span class="p">),</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;pre&#39;</span><span class="p">,</span><span class="s1">&#39;truoc&#39;</span><span class="p">,</span><span class="s1">&#39;tt&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">paytype</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;prepaid&#39;</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;post&#39;</span><span class="p">,</span><span class="s1">&#39;sau&#39;</span><span class="p">,</span><span class="s1">&#39;ts&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">paytype</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;postpaid&#39;</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="si">
<h2><span class="section-number">3.7. </span>SI<a class="headerlink" href="#si" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SI</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Chuẩn hóa mã số BHXH</span>

<span class="sd">    Args:</span>
<span class="sd">        text (_type_): _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">cleankey</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">def</span> <span class="nf">isAllNumber</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">char</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">():</span>
                    <span class="k">return</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">def</span> <span class="nf">returnNumberSI</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
            <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:010.0f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span>
            <span class="k">return</span> <span class="n">text</span> 


        <span class="n">cleaned</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">isAllNumber</span><span class="p">(</span><span class="n">cleaned</span><span class="p">):</span>
            <span class="n">cleaned</span> <span class="o">=</span> <span class="n">returnNumberSI</span><span class="p">(</span><span class="n">cleaned</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">cleaned</span>
        
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;0*[0-9]{7,10}[a-zA-Z]{0,3}$&quot;</span><span class="p">,</span> <span class="n">cleaned</span><span class="p">):</span>
            <span class="n">alpha_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cleaned</span> <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()])</span>
            <span class="n">number_comp</span> <span class="o">=</span> <span class="n">returnNumberSI</span><span class="p">(</span><span class="n">cleaned</span><span class="p">[:</span><span class="o">-</span><span class="n">alpha_len</span><span class="p">])</span>
            <span class="n">cleaned</span> <span class="o">=</span> <span class="n">number_comp</span> <span class="o">+</span> <span class="n">cleaned</span><span class="p">[</span><span class="o">-</span><span class="n">alpha_len</span><span class="p">:]</span>
            <span class="k">return</span> <span class="n">cleaned</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span>

    <span class="k">def</span> <span class="nf">standardize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">error</span> <span class="o">=</span> <span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">cleankey</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">error</span> <span class="o">==</span> <span class="s1">&#39;ignore&#39;</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
            <span class="k">if</span> <span class="n">error</span> <span class="o">==</span> <span class="s1">&#39;nan&#39;</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="k">return</span> <span class="n">res</span>       
</pre></div>
</div>
</div>
</div>
</section>
<section id="taxid">
<h2><span class="section-number">3.8. </span>TaxID<a class="headerlink" href="#taxid" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">TaxID</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="k">if</span> <span class="p">((</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">value</span> <span class="o">!=</span> <span class="n">value</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">))</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cleaned</span> <span class="o">=</span> <span class="n">value</span> <span class="k">if</span> <span class="p">(</span><span class="n">value</span> <span class="o">!=</span> <span class="n">value</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">taxID_clean</span><span class="p">()</span> 

    <span class="k">def</span> <span class="nf">taxID_clean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value_input</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="k">if</span> <span class="n">value_input</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">value_input</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;0*[0-9]{8,10}(-[0-9]{1,3})?$&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;[0-9]{8,10}-[0-9]{1,3}$&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;[0-9]{8,10}$&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s1">&#39;dv_chu_quan&#39;</span>
                    <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{:010.0f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s1">&#39;dv_chi_nhanh&#39;</span>
                <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{:010.0f}</span><span class="s2">-</span><span class="si">{:03.0f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value_input</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">value_clean</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">clean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">taxID_clean</span><span class="p">(</span><span class="n">value_clean</span><span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="header-cleaning">
<h2><span class="section-number">3.9. </span>Header cleaning<a class="headerlink" href="#header-cleaning" title="Permalink to this heading">#</a></h2>
<p>The following sections demonstrate the functionality of <code class="docutils literal notranslate"><span class="pre">clean_headers()</span></code>.</p>
<p>Column names can be converted to the following case styles via the <code class="docutils literal notranslate"><span class="pre">case</span></code> parameter:</p>
<ul class="simple">
<li><p>snake: “column_name”</p></li>
<li><p>kebab: “column-name”</p></li>
<li><p>camel: “columnName”</p></li>
<li><p>pascal: “ColumnName”</p></li>
<li><p>const: “COLUMN_NAME”</p></li>
<li><p>sentence: “Column name”</p></li>
<li><p>title: “Column Name”</p></li>
<li><p>lower: “column name”</p></li>
<li><p>upper: “COLUMN NAME”</p></li>
</ul>
<p>After cleaning, a <strong>report</strong> is printed that provides the number and percentage of values that were cleaned (the value must be transformed).</p>
<p>An example dirty dataset</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;ISBN&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">9781455582341</span><span class="p">],</span>
            <span class="s2">&quot;isbn&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1455582328</span><span class="p">],</span>
            <span class="s2">&quot;bookTitle&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;How Google Works&quot;</span><span class="p">],</span>
            <span class="s2">&quot;__Author&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Eric Schmidt, Jonathan Rosenberg&quot;</span><span class="p">],</span>
            <span class="s2">&quot;Publication (year)&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2014</span><span class="p">],</span>
            <span class="s2">&quot;éditeur&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Grand Central Publishing&quot;</span><span class="p">],</span>
            <span class="s2">&quot;Number_Of_Pages&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">305</span><span class="p">],</span>
            <span class="s2">&quot;★ Rating&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">4.06</span><span class="p">],</span>
        <span class="p">}</span>
    <span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ISBN</th>
      <th>isbn</th>
      <th>bookTitle</th>
      <th>__Author</th>
      <th>Publication (year)</th>
      <th>éditeur</th>
      <th>Number_Of_Pages</th>
      <th>★ Rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9781455582341</td>
      <td>1455582328</td>
      <td>How Google Works</td>
      <td>Eric Schmidt, Jonathan Rosenberg</td>
      <td>2014</td>
      <td>Grand Central Publishing</td>
      <td>305</td>
      <td>4.06</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Default <code class="docutils literal notranslate"><span class="pre">clean_headers()</span></code></p>
<p>By default, the <code class="docutils literal notranslate"><span class="pre">case</span></code> parameter is set to “snake” and the <code class="docutils literal notranslate"><span class="pre">remove_accents</span></code> parameter is set to True (strip accents and symbols from the column name).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dataprep.clean</span> <span class="kn">import</span> <span class="n">clean_headers</span>
<span class="n">clean_headers</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column Headers Cleaning Report:
	8 values cleaned (100.0%)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>isbn</th>
      <th>isbn_1</th>
      <th>book_title</th>
      <th>author</th>
      <th>publication_year</th>
      <th>editeur</th>
      <th>number_of_pages</th>
      <th>rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9781455582341</td>
      <td>1455582328</td>
      <td>How Google Works</td>
      <td>Eric Schmidt, Jonathan Rosenberg</td>
      <td>2014</td>
      <td>Grand Central Publishing</td>
      <td>305</td>
      <td>4.06</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Note that “_1” is appended to the second instance of the column name “isbn” to distinguish it from the first instance after the transformation. Consequently, all column names are considered to have been cleaned in this example.</p>
<p>Column names that are duplicated as a result of calling <code class="docutils literal notranslate"><span class="pre">clean_headers()</span></code> are automatically renamed to append a number to the end. The suffix used to append the number is inferred from the <code class="docutils literal notranslate"><span class="pre">case</span></code> parameter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clean_headers</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="s2">&quot;kebab&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column Headers Cleaning Report:
	8 values cleaned (100.0%)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>isbn</th>
      <th>isbn-1</th>
      <th>book-title</th>
      <th>author</th>
      <th>publication-year</th>
      <th>editeur</th>
      <th>number-of-pages</th>
      <th>rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9781455582341</td>
      <td>1455582328</td>
      <td>How Google Works</td>
      <td>Eric Schmidt, Jonathan Rosenberg</td>
      <td>2014</td>
      <td>Grand Central Publishing</td>
      <td>305</td>
      <td>4.06</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clean_headers</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="s2">&quot;camel&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column Headers Cleaning Report:
	7 values cleaned (87.5%)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>isbn</th>
      <th>isbn1</th>
      <th>bookTitle</th>
      <th>author</th>
      <th>publicationYear</th>
      <th>editeur</th>
      <th>numberOfPages</th>
      <th>rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9781455582341</td>
      <td>1455582328</td>
      <td>How Google Works</td>
      <td>Eric Schmidt, Jonathan Rosenberg</td>
      <td>2014</td>
      <td>Grand Central Publishing</td>
      <td>305</td>
      <td>4.06</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clean_headers</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="s2">&quot;pascal&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column Headers Cleaning Report:
	8 values cleaned (100.0%)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Isbn</th>
      <th>Isbn1</th>
      <th>BookTitle</th>
      <th>Author</th>
      <th>PublicationYear</th>
      <th>Editeur</th>
      <th>NumberOfPages</th>
      <th>Rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9781455582341</td>
      <td>1455582328</td>
      <td>How Google Works</td>
      <td>Eric Schmidt, Jonathan Rosenberg</td>
      <td>2014</td>
      <td>Grand Central Publishing</td>
      <td>305</td>
      <td>4.06</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clean_headers</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="s2">&quot;const&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column Headers Cleaning Report:
	7 values cleaned (87.5%)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ISBN</th>
      <th>ISBN_1</th>
      <th>BOOK_TITLE</th>
      <th>AUTHOR</th>
      <th>PUBLICATION_YEAR</th>
      <th>EDITEUR</th>
      <th>NUMBER_OF_PAGES</th>
      <th>RATING</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9781455582341</td>
      <td>1455582328</td>
      <td>How Google Works</td>
      <td>Eric Schmidt, Jonathan Rosenberg</td>
      <td>2014</td>
      <td>Grand Central Publishing</td>
      <td>305</td>
      <td>4.06</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clean_headers</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="s2">&quot;sentence&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column Headers Cleaning Report:
	7 values cleaned (87.5%)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Isbn</th>
      <th>Isbn 1</th>
      <th>Book title</th>
      <th>Author</th>
      <th>Publication (year)</th>
      <th>Editeur</th>
      <th>Number of pages</th>
      <th>Rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9781455582341</td>
      <td>1455582328</td>
      <td>How Google Works</td>
      <td>Eric Schmidt, Jonathan Rosenberg</td>
      <td>2014</td>
      <td>Grand Central Publishing</td>
      <td>305</td>
      <td>4.06</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clean_headers</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="s2">&quot;title&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column Headers Cleaning Report:
	7 values cleaned (87.5%)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Isbn</th>
      <th>Isbn 1</th>
      <th>Book Title</th>
      <th>Author</th>
      <th>Publication (year)</th>
      <th>Editeur</th>
      <th>Number Of Pages</th>
      <th>Rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9781455582341</td>
      <td>1455582328</td>
      <td>How Google Works</td>
      <td>Eric Schmidt, Jonathan Rosenberg</td>
      <td>2014</td>
      <td>Grand Central Publishing</td>
      <td>305</td>
      <td>4.06</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clean_headers</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column Headers Cleaning Report:
	8 values cleaned (100.0%)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>isbn</th>
      <th>isbn 1</th>
      <th>book title</th>
      <th>author</th>
      <th>publication (year)</th>
      <th>editeur</th>
      <th>number of pages</th>
      <th>rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9781455582341</td>
      <td>1455582328</td>
      <td>How Google Works</td>
      <td>Eric Schmidt, Jonathan Rosenberg</td>
      <td>2014</td>
      <td>Grand Central Publishing</td>
      <td>305</td>
      <td>4.06</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clean_headers</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column Headers Cleaning Report:
	7 values cleaned (87.5%)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ISBN</th>
      <th>ISBN 1</th>
      <th>BOOK TITLE</th>
      <th>AUTHOR</th>
      <th>PUBLICATION (YEAR)</th>
      <th>EDITEUR</th>
      <th>NUMBER OF PAGES</th>
      <th>RATING</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9781455582341</td>
      <td>1455582328</td>
      <td>How Google Works</td>
      <td>Eric Schmidt, Jonathan Rosenberg</td>
      <td>2014</td>
      <td>Grand Central Publishing</td>
      <td>305</td>
      <td>4.06</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./2_My_Modules"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../4_Programming/7_Docker.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">2.6. </span>Docker</p>
      </div>
    </a>
    <a class="right-next"
       href="2_Connection.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Connection</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#text">3.1. Text</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#custom-function">3.1.1. Custom function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dataprep-clean-text">3.1.2. Dataprep clean text</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#address">3.2. Address</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datetime">3.3. Datetime</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#person-info">3.4. Person info</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#idcard">3.5. IDCard</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#phone-number">3.6. Phone number</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#si">3.7. SI</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#taxid">3.8. TaxID</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#header-cleaning">3.9. Header cleaning</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Khổng Tiến Đạt
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>